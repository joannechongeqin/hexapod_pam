from Yuna import Yuna
import time
import torch
import numpy as np

yuna = Yuna(real_robot_control=0, pybullet_on=1, zed_on=True) # , goal=pos.tolist())
yuna.env.camerafollow = False
# time.sleep(2)
# yuna.height_map.plot()

leg_idxs = [1]
pos = torch.tensor([[1.45, -0.3, 0.7]])
# yuna.pam_press_button(pos, 1)

# leg_idxs = [0, 1]
# pos = torch.tensor([[1.4, 0.3, 0.6], [1.4, -0.3, 0.6]])
# yuna.pam(pos, leg_idxs)


# --- RAISE ONE: TEST SET 1 ---
# body_waypoints = np.array([
#     [0.1419, 0.019, 0.1654],
#     [0.2829, 0.0294, 0.2745],
#     [0.4245, 0.0462, 0.2988],
#     [0.5641, 0.0559, 0.2803],
#     [0.7079, 0.0742, 0.37],
#     [0.848, 0.0906, 0.3968]
# ], dtype=np.float32)

# legs_waypoints = np.array([
#     [[0.6388, 0.6382, 0.1753, 0.181, -0.3125, -0.3161],
#      [0.2601, -0.2203, 0.5248, -0.4851, 0.3358, -0.2934],
#      [0.0259, 0.0255, 0.0243, 0.0265, 0.0246, 0.0261]],
#     [[0.7441, 0.7435, 0.3383, 0.3413, -0.1741, -0.1797],
#      [0.2763, -0.2182, 0.5432, -0.4821, 0.3463, -0.2899],
#      [0.2081, 0.2088, 0.0315, 0.0356, 0.0307, 0.0358]],
#     [[0.8851, 0.8938, 0.4752, 0.4675, -0.0413, -0.035],
#      [0.3035, -0.2112, 0.5611, -0.4687, 0.3638, -0.2691],
#      [0.2181, 0.2166, 0.0418, 0.0375, 0.0426, 0.035]],
#     [[1.0231, 1.0228, 0.6003, 0.5905, 0.0983, 0.1096],
#      [0.3169, -0.2116, 0.5687, -0.4565, 0.3766, -0.2713],
#      [0.2093, 0.2096, 0.0538, 0.0467, 0.0638, 0.0591]],
#     [[1.1638, 1.1594, 0.7411, 0.7434, 0.255, 0.2535],
#      [0.3321, -0.1882, 0.5811, -0.4313, 0.3763, -0.2293],
#      [0.3065, 0.3068, 0.2233, 0.2223, 0.0425, 0.0388]],
#     [[1.3426, 1.4028, 0.9865, 1.0742, 0.4148, 0.4699],
#      [0.1473, -0.2984, 0.5589, -0.3451, 0.3898, -0.2757],
#      [0.3233, 0.5076, 0.2491, 0.2275, 0.0341, 0.0412]]
# ], dtype=np.float32)

# --- RAISE ONE: TEST SET 2 (BETTER) ---
body_waypoints = np.array([
    [0.1434, -0.0003, 0.2016],
    [0.2828, -0.0019, 0.2681],
    [0.4254, -0.0018, 0.3217],
    [0.5652, -0.0043, 0.3340],
    [0.7045, -0.0033, 0.3571],
    [0.8477, -0.0061, 0.4140]
], dtype=np.float32)

legs_waypoints = np.array([
    [[0.6115, 0.6056, 0.1351, 0.1395, -0.3237, -0.3230],
     [0.3010, -0.3085, 0.5078, -0.5077, 0.2996, -0.3015],
     [0.0274, 0.0270, 0.0210, 0.0210, 0.0289, 0.0294]],
    [[0.7367, 0.7304, 0.3606, 0.3656, -0.1708, -0.1664],
     [0.2254, -0.2323, 0.4987, -0.5021, 0.3225, -0.3315],
     [0.2183, 0.2265, 0.0261, 0.0260, 0.0265, 0.0262]],
    [[0.8913, 0.8834, 0.4664, 0.4656, -0.0342, -0.0234],
     [0.2539, -0.2745, 0.5022, -0.5014, 0.3044, -0.3178],
     [0.2284, 0.2251, 0.0316, 0.0276, 0.0286, 0.0262]],
    [[1.0398, 1.0125, 0.5930, 0.6079, 0.1076, 0.1187],
     [0.2548, -0.2985, 0.4933, -0.5006, 0.3003, -0.3247],
     [0.2213, 0.2309, 0.0257, 0.0211, 0.0321, 0.0304]],
    [[1.1453, 1.1517, 0.7611, 0.7674, 0.2618, 0.2487],
     [0.2291, -0.2259, 0.4871, -0.4965, 0.3069, -0.2997],
     [0.3227, 0.3207, 0.2256, 0.2228, 0.0279, 0.0295]],
    [[1.3390, 1.4504, 0.8909, 1.0356, 0.4073, 0.4082],
     [0.0776, -0.2988, 0.4981, -0.4554, 0.2686, -0.2879],
     [0.3351, 0.7004, 0.2280, 0.2245, 0.0331, 0.0355]]
], dtype=np.float32)

# yuna._plot_hexapod_path(body_waypoints, legs_waypoints)
yuna.pam_move(body_waypoints, legs_waypoints, ("press_button", 1))


time.sleep(100)